<script>
  function formatINR(x) {
    return new Intl.NumberFormat('en-IN', {
      style: 'currency',
      currency: 'INR'
    }).format(x);
  }

  function calculateGoal() {
    const goalAmount = parseFloat(document.getElementById('goalAmount').value);
    const inflationRate = parseFloat(document.getElementById('inflationRate').value);
    const years = parseFloat(document.getElementById('years').value);
    const returnRate = parseFloat(document.getElementById('returnRate').value);

    const inflatedGoal = goalAmount * Math.pow(1 + inflationRate / 100, years);
    const monthlyRate = returnRate / 12 / 100;
    const totalMonths = years * 12;

    const monthlyInvestment = inflatedGoal * monthlyRate / (Math.pow(1 + monthlyRate, totalMonths) - 1);
    const totalInvestment = monthlyInvestment * totalMonths;
    const growth = inflatedGoal - totalInvestment;

    document.getElementById('displayInflatedGoal').innerText =
      "Future Goal Amount (inflation-adjusted): " + formatINR(inflatedGoal);
    document.getElementById('displayMonthlyInvestment').innerText =
      "Monthly Investment Required: " + formatINR(monthlyInvestment);
    document.getElementById('results').style.display = "block";

    const ctx = document.getElementById('goalChart').getContext('2d');
    if (window.goalChart) window.goalChart.destroy();
    window.goalChart = new Chart(ctx, {
      type: 'pie',
      data: {
        labels: ['Monthly Contributions (Total)', 'Returns (Growth)'],
        datasets: [{
          data: [totalInvestment, growth],
          backgroundColor: ['green', 'red']
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: {
            position: 'top',
            labels: {
              color: '#000',
              font: {
                size: 14
              }
            }
          }
        }
      }
    });
  }
</script>
